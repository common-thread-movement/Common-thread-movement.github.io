<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Common Thread · Field Kit</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Your existing site styles -->
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <header>
    <h1>Common Thread · Field Kit</h1>
    <p>Quiet operations for responsible citizens.</p>
  </header>

  <section class="content-box">

    <!-- ========== DOCUMENT LINKS ========== -->
    <h2>Field Documents</h2>
    <p>Tap any document below to open it:</p>

    <ul>
      <li>
        <a href="docs/Fourpages.pdf" target="_blank">
          CT-PRC-004 — Principles Package (4-Page Brief)
        </a>
      </li>

      <li>
        <a href="docs/handbook.pdf" target="_blank">
          CT-HBK-001 — Internal Handbook (Restricted)
        </a>
      </li>

      <li>
        <a href="docs/Fieldkit.pdf" target="_blank">
          CT-FLD-010 — Field Kit (Operator Issue)
        </a>
      </li>
    </ul>


    <!-- ========== DAILY CHECKLIST ========== -->
    <h2>Daily Operations Checklist</h2>

    <form id="dailyChecklist">

      <label>
        <input type="checkbox" id="bathroomClean">
        Bathroom cleaned today
      </label>
      <br>

      <label>
        <input type="checkbox" id="serviceDone">
        Completed one act of quiet service
      </label>
      <br>

      <label>
        Times I chose curiosity over anger today:
        <input type="number" id="curiosityCount" min="0" value="0">
      </label>
      <br><br>

      <label>
        Notes:
        <br>
        <textarea id="notes" rows="3"></textarea>
      </label>
      <br><br>

      <button type="button" onclick="saveChecklist()">Save Today’s Entry</button>
    </form>

    <p id="saveMessage" style="color: #5f5; font-weight: bold;"></p>

    <p style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.8;">
      Tip: On your phone, open this page and use your browser’s
      <strong>Add to Home Screen</strong> option to keep it like an app.
    </p>

  </section>

  <!-- ========== CHECKLIST SCRIPT & SERVICE WORKER REGISTER ========== -->
  <script>
    // Load saved values when page loads
    document.addEventListener("DOMContentLoaded", function() {

      // Checklist load
      var bathroom = document.getElementById("bathroomClean");
      var service = document.getElementById("serviceDone");
      var curiosity = document.getElementById("curiosityCount");
      var notes = document.getElementById("notes");

      if (bathroom) {
        bathroom.checked = localStorage.getItem("bathroomClean") === "true";
      }
      if (service) {
        service.checked = localStorage.getItem("serviceDone") === "true";
      }
      if (curiosity) {
        curiosity.value = localStorage.getItem("curiosityCount") || 0;
      }
      if (notes) {
        notes.value = localStorage.getItem("notes") || "";
      }

      // Service worker registration for PWA
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js')
          .catch(function (err) {
            console.log('Service worker registration failed:', err);
          });
      }
    });

    // Save function
    function saveChecklist() {
      var bathroom = document.getElementById("bathroomClean");
      var service = document.getElementById("serviceDone");
      var curiosity = document.getElementById("curiosityCount");
      var notes = document.getElementById("notes");

      if (bathroom) {
        localStorage.setItem("bathroomClean", bathroom.checked);
      }
      if (service) {
        localStorage.setItem("serviceDone", service.checked);
      }
      if (curiosity) {
        localStorage.setItem("curiosityCount", curiosity.value);
      }
      if (notes) {
        localStorage.setItem("notes", notes.value);
      }

      var msg = document.getElementById("saveMessage");
      if (msg) {
        msg.innerText = "Checklist saved ✔";
      }
    }
  </script>

</body>
</html>
